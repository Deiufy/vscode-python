name: '$(Year:yyyy).$(Month).0.$(BuildID)-ci'

# PR Validation build.
# Notes: Only trigger a PR build for master and release, and skip build/rebuild
#        on changes in the news and .vscode folders.
pr:
  autoCancel: true
  branches:
    include: ["master", "release"]
  paths:
    exclude: ["/news/1 Enhancements", "/news/2 Fixes", "/news/3 Code Health", "/.vscode"]

# Not the CI build for merges to master and release.
trigger: none

# Variables that are available for the entire pipeline.
variables:
  PythonVersion: '3.7'
  NodeVersion: '10.5.0'
  NpmVersion: 'latest'
  MOCHA_FILE: '$(Build.ArtifactStagingDirectory)/test-junit.xml' # All test files will write their JUnit xml output to this file, clobbering the last time it was written.
  MOCHA_REPORTER_JUNIT: true # Use the mocha-multi-reporters and send output to both console (spec) and JUnit (mocha-junit-reporter).
  VSC_PYTHON_FORCE_LOGGING: true # Enable this to turn on console output for the logger

jobs:
- template: templates/build_compile_jobs.yml

- template: templates/uitest_jobs.yml
  parameters:
    jobs:
    - test: "Smoke"
      tags: "--tags=@smoke"
    - test: "Test"
      tags: "--tags=@test"
    - test: "Terminal"
      tags: "--tags=@terminal --tags=~@terminal.pipenv"

